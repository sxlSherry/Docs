# 自定义注解不生效

​	本篇谈一谈自定义注解不生效的情况和原因。

​	自定义注解+切面是很常用的，但有时候就会遇到奇奇怪怪自定义注解不生效的情况。

## 情况一：

### 原因

​	自定义注解标注的方法如果被本类调用，活动不到代理对象，自己注解失效。

​	这个我之前遇到过一次，其实很多注解失效都会是这个原因（比如我之前写的

[@Async 注解不生效]: https://sxlsherry.github.io/Study-Notes/#/study/%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98%E8%AE%B0%E5%BD%95/@Async%E6%B3%A8%E8%A7%A3%E4%B8%8D%E7%94%9F%E6%95%88

）。以后遇到可以优先考虑。

### 解决方式

	1. 最简单的方式当然是不要写在一个类里面；
	1. 另外的解决方式是通过AopContext获取当前类的代理对象，调用该方法可解决注解失效问题。



## 情况二：

### 问题

​	自定义注解加在方法上可以使用，但是直接加在controller的类上失效。

### 解决方式

​	这个我没找到解决方式，因为我遇到过好多次了，查了很久也没有找到原因和解决方式。所以我现在一般只使用方法级的自定义注解。

​	给自己留个任务，有时间的时候从源代码去找找原因，看看有没有解决方案。如果有朋友知道，欢迎告知。